/home/sheng/anaconda3/envs/opentools-new
{'tool_name': 'Object_Detector_Tool', 'tool_description': 'A tool that detects objects in an image using the Grounding DINO model and saves individual object images with empty padding.', 'tool_version': '1.0.0', 'input_types': {'image': 'str - The path to the image file.', 'labels': 'list - A list of object labels to detect.', 'threshold': 'float - The confidence threshold for detection (default: 0.35).', 'model_size': "str - The size of the model to use ('tiny' or 'base', default: 'tiny').", 'padding': 'int - The number of pixels to add as empty padding around detected objects (default: 20).'}, 'output_type': 'list - A list of detected objects with their scores, bounding boxes, and saved image paths.', 'demo_commands': [{'command': 'execution = tool.execute(image="path/to/image.png", labels=["baseball", "basket"])', 'description': 'Detect baseball and basket in an image, save the detected objects with default empty padding, and return their paths.'}, {'command': 'execution = tool.execute(image="path/to/image.png", labels=["car", "person"], threshold=0.5, model_size="base", padding=15)', 'description': 'Detect car and person in an image using the base model, save the detected objects with 15 pixels of empty padding, and return their paths.'}], 'require_llm_engine': False, 'user_metadata': {'limitation': 'The model may not always detect objects accurately, and its performance can vary depending on the input image and the associated labels. It typically struggles with detecting small objects, objects that are uncommon, or objects with limited or specific attributes. For improved accuracy or better detection in certain situations, consider using supplementary tools or image processing techniques to provide additional information for verification.'}}
Could not load the custom kernel for multi-scale deformable attention: Error building extension 'MultiScaleDeformableAttention': [1/4] /home/sheng/anaconda3/envs/opentools-new/bin/nvcc --generate-dependencies-with-compile --dependency-output ms_deform_attn_cuda.cuda.o.d -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/TH -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/THC -isystem /home/sheng/anaconda3/envs/opentools-new/include -isystem /home/sheng/anaconda3/envs/octotools/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_86,code=compute_86 -gencode=arch=compute_86,code=sm_86 --compiler-options '-fPIC' -DCUDA_HAS_FP16=1 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ -std=c++17 -c /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/cuda/ms_deform_attn_cuda.cu -o ms_deform_attn_cuda.cuda.o 
FAILED: ms_deform_attn_cuda.cuda.o 
/home/sheng/anaconda3/envs/opentools-new/bin/nvcc --generate-dependencies-with-compile --dependency-output ms_deform_attn_cuda.cuda.o.d -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/TH -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/THC -isystem /home/sheng/anaconda3/envs/opentools-new/include -isystem /home/sheng/anaconda3/envs/octotools/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_86,code=compute_86 -gencode=arch=compute_86,code=sm_86 --compiler-options '-fPIC' -DCUDA_HAS_FP16=1 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ -std=c++17 -c /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/cuda/ms_deform_attn_cuda.cu -o ms_deform_attn_cuda.cuda.o 
/bin/sh: 1: /home/sheng/anaconda3/envs/opentools-new/bin/nvcc: not found
[2/4] c++ -MMD -MF ms_deform_attn_cpu.o.d -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/TH -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/THC -isystem /home/sheng/anaconda3/envs/opentools-new/include -isystem /home/sheng/anaconda3/envs/octotools/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -DWITH_CUDA=1 -c /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/cpu/ms_deform_attn_cpu.cpp -o ms_deform_attn_cpu.o 
[3/4] c++ -MMD -MF vision.o.d -DTORCH_EXTENSION_NAME=MultiScaleDeformableAttention -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/TH -isystem /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/THC -isystem /home/sheng/anaconda3/envs/opentools-new/include -isystem /home/sheng/anaconda3/envs/octotools/include/python3.10 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -DWITH_CUDA=1 -c /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/vision.cpp -o vision.o 
In file included from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/vision.cpp:11:
/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/ms_deform_attn.h: In function ‘at::Tensor ms_deform_attn_forward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/ms_deform_attn.h:29:19: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   29 |     if (value.type().is_cuda())
      |         ~~~~~~~~~~^~
In file included from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/cpu/ms_deform_attn_cpu.h:12,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/ms_deform_attn.h:13,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/vision.cpp:11:
/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      |                              ^~~~
In file included from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/vision.cpp:11:
/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/ms_deform_attn.h: In function ‘std::vector<at::Tensor> ms_deform_attn_backward(const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, const at::Tensor&, int)’:
/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/ms_deform_attn.h:51:19: warning: ‘at::DeprecatedTypeProperties& at::Tensor::type() const’ is deprecated: Tensor.type() is deprecated. Instead use Tensor.options(), which in many cases (e.g. in a constructor) is a drop-in replacement. If you were using data from type(), that is now available from Tensor itself, so instead of tensor.type().scalar_type(), use tensor.scalar_type() instead and instead of tensor.type().backend() use tensor.device(). [-Wdeprecated-declarations]
   51 |     if (value.type().is_cuda())
      |         ~~~~~~~~~~^~
In file included from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/ATen/Tensor.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/torch/extension.h:5,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/cpu/ms_deform_attn_cpu.h:12,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/ms_deform_attn.h:13,
                 from /home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/transformers/kernels/deformable_detr/vision.cpp:11:
/home/sheng/anaconda3/envs/octotools/lib/python3.10/site-packages/torch/include/ATen/core/TensorBody.h:225:30: note: declared here
  225 |   DeprecatedTypeProperties & type() const {
      |                              ^~~~
ninja: build stopped: subcommand failed.

Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Could not load the custom kernel for multi-scale deformable attention: /home/sheng/.cache/torch_extensions/py310_cu121/MultiScaleDeformableAttention/MultiScaleDeformableAttention.so: cannot open shared object file: No such file or directory
Detected Objects:
Detected baseball with confidence 0.69
Bounding box: (558, 48, 615, 107)
Saved image (with padding): detected_objects/baseball_baseball_1.png

Detected baseball with confidence 0.69
Bounding box: (614, 137, 671, 191)
Saved image (with padding): detected_objects/baseball_baseball_2.png

Detected baseball with confidence 0.68
Bounding box: (132, 67, 189, 126)
Saved image (with padding): detected_objects/baseball_baseball_3.png

Detected baseball with confidence 0.68
Bounding box: (632, 67, 690, 126)
Saved image (with padding): detected_objects/baseball_baseball_4.png

Detected baseball with confidence 0.68
Bounding box: (57, 289, 115, 346)
Saved image (with padding): detected_objects/baseball_baseball_5.png

Detected baseball with confidence 0.68
Bounding box: (535, 111, 592, 170)
Saved image (with padding): detected_objects/baseball_baseball_6.png

Detected baseball with confidence 0.68
Bounding box: (307, 48, 365, 107)
Saved image (with padding): detected_objects/baseball_baseball_7.png

Detected baseball with confidence 0.68
Bounding box: (114, 137, 171, 191)
Saved image (with padding): detected_objects/baseball_baseball_8.png

Detected baseball with confidence 0.68
Bounding box: (35, 351, 91, 410)
Saved image (with padding): detected_objects/baseball_baseball_9.png

Detected baseball with confidence 0.68
Bounding box: (57, 48, 115, 107)
Saved image (with padding): detected_objects/baseball_baseball_10.png

Detected baseball with confidence 0.68
Bounding box: (35, 111, 91, 170)
Saved image (with padding): detected_objects/baseball_baseball_11.png

Detected baseball with confidence 0.68
Bounding box: (364, 137, 421, 191)
Saved image (with padding): detected_objects/baseball_baseball_12.png

Detected baseball with confidence 0.68
Bounding box: (114, 377, 171, 430)
Saved image (with padding): detected_objects/baseball_baseball_13.png

Detected baseball with confidence 0.67
Bounding box: (132, 307, 189, 366)
Saved image (with padding): detected_objects/baseball_baseball_14.png

Detected baseball with confidence 0.67
Bounding box: (285, 111, 342, 170)
Saved image (with padding): detected_objects/baseball_baseball_15.png

Detected baseball with confidence 0.67
Bounding box: (382, 67, 439, 126)
Saved image (with padding): detected_objects/baseball_baseball_16.png

Detected baseball with confidence 0.65
Bounding box: (587, 94, 643, 153)
Saved image (with padding): detected_objects/baseball_baseball_17.png

Detected baseball with confidence 0.65
Bounding box: (86, 94, 143, 153)
Saved image (with padding): detected_objects/baseball_baseball_18.png

Detected baseball with confidence 0.65
Bounding box: (86, 335, 143, 393)
Saved image (with padding): detected_objects/baseball_baseball_19.png

Detected baseball with confidence 0.63
Bounding box: (336, 95, 393, 153)
Saved image (with padding): detected_objects/baseball_baseball_20.png

Detected basket with confidence 0.59
Bounding box: (252, 2, 468, 215)
Saved image (with padding): detected_objects/baseball_basket_1.png

Detected basket with confidence 0.55
Bounding box: (503, 2, 717, 215)
Saved image (with padding): detected_objects/baseball_basket_2.png

Detected basket with confidence 0.54
Bounding box: (2, 2, 217, 215)
Saved image (with padding): detected_objects/baseball_basket_3.png

Detected basket with confidence 0.5
Bounding box: (2, 242, 217, 455)
Saved image (with padding): detected_objects/baseball_basket_4.png

Done!
